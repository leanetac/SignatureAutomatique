function action(e){var t=Office.context.roamingSettings;jQuery.ajax({url:"https://vcard.thinkad.club/api/index.php",method:"POST",jsonp:!0,data:{mail:Office.context.mailbox.userProfile.emailAddress},success:function(e){t.set("tmplSignature","signatureVcard"),t.set("signatureContent",e),t.saveAsync(),insert_signature(e)}}),e.completed()}function deleteSignature(e){var t=Office.context.roamingSettings;t.remove("tmplSignature"),t.remove("signatureContent"),t.saveAsync(),Office.context.mailbox.item.body.setAsync("",{coercionType:Office.CoercionType.Html},(function(e){console.log("Suppression de la signature provenant de la plateforme de contact")}))}function getGlobal(){return"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:void 0}function set_body(e){Office.context.mailbox.item.body.setAsync(get_cal_offset()+e,{coercionType:Office.CoercionType.Html},(function(e){console.log("set_body - "+JSON.stringify(e))}))}function set_signature(e){Office.context.mailbox.item.body.setSignatureAsync(e,{coercionType:Office.CoercionType.Html},(function(e){console.log("set_signature - "+JSON.stringify(e))}))}function insert_signature(e){Office.context.mailbox.item.itemType==Office.MailboxEnums.ItemType.Appointment?set_body(e):set_signature(e)}Office.onReady((function(){}));var g=getGlobal();g.action=action;