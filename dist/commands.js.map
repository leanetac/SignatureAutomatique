{"version":3,"file":"commands.js","mappings":"YACA,IAAIA,EAAsB,CAAC,ECD3BA,EAAoBC,EAAI,WACvB,GAA0B,iBAAfC,WAAyB,OAAOA,WAC3C,IACC,OAAOC,MAAQ,IAAIC,SAAS,cAAb,EAChB,CAAE,MAAOC,GACR,GAAsB,iBAAXC,OAAqB,OAAOA,MACxC,CACA,CAPuB,GCAxBC,OAAOC,SAAQ,WACb,KAsDuB,oBAATC,KACVA,KACkB,oBAAXH,OACPA,YACkB,IAAXI,EAAAA,EACPA,EAAAA,OACAC,GAwDJC,OA7GF,SAAgBC,GAEf,IAAIC,EAAYP,OAAOQ,QAAQC,gBAG/BC,OAAOC,KAAK,CACXC,IAAK,2CACLC,OAAQ,OACRC,OAAO,EACPC,KAAM,CAAC,KAAQf,OAAOQ,QAAQQ,QAAQC,YAAYC,cAClDC,QAAS,SAACC,GAoFZ,IAA0BC,EAlFvBd,EAAUe,IAAI,gBAAiB,kBAC/Bf,EAAUe,IAAI,mBAAoBF,GAClCb,EAAUgB,YAgFaF,EA9END,EAgFdpB,OAAOQ,QAAQQ,QAAQQ,KAAKC,UAAYzB,OAAO0B,aAAaC,SAASC,YApC3E,SAAkBP,GAEhBrB,OAAOQ,QAAQQ,QAAQQ,KAAKK,KAAKC,SAElCC,iBAAmBV,EACnB,CAACW,aAAchC,OAAOiC,aAAaC,OACnC,SAAUC,GAERC,QAAQC,IAAI,cAAgBC,KAAKC,UAAUJ,GAC7C,GAED,CA2BCK,CAASnB,GArBV,SAAuBA,GAErBrB,OAAOQ,QAAQQ,QAAQQ,KAAKK,KAAKY,kBAElCpB,EACA,CAACW,aAAchC,OAAOiC,aAAaC,OACnC,SAAUC,GAERC,QAAQC,IAAI,mBAAqBC,KAAKC,UAAUJ,GAClD,GAED,CAcCO,CAAcrB,EArFb,IAKAf,EAAMqC,WACR,C","sources":["webpack://office-addin-taskpane-js/webpack/bootstrap","webpack://office-addin-taskpane-js/webpack/runtime/global","webpack://office-addin-taskpane-js/./src/commands/commands.js"],"sourcesContent":["// The require scope\nvar __webpack_require__ = {};\n\n","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","Office.onReady(() => {\n  // If needed, Office.js is ready to be called\n});\n\n/**\n * R�cup�ration de la signature de l'utilisateur sur la plateforme de contact\n * @param event {Office.AddinCommands.Event}\n */\nfunction action(event) {\n\n\tlet _settings = Office.context.roamingSettings;\n\n\t// R�cup�ration de la signature\n\tjQuery.ajax({\n\t\turl: 'https://vcard.thinkad.club/api/index.php',\n\t\tmethod: 'POST',\n\t\tjsonp: true,\n\t\tdata: {'mail': Office.context.mailbox.userProfile.emailAddress},\n\t\tsuccess: (resp) => {\n\t\t\t// Sauvegarde de la signature dans les param�tres de l'Add-in\n\t\t\t_settings.set('tmplSignature', 'signatureVcard');\n\t\t\t_settings.set('signatureContent', resp);\n\t\t\t_settings.saveAsync();\n\t\t\t// Insertion de la signature dans le mail\n\t\t\tinsert_signature(resp);\n\t\t}\n\t})\n  \n\n  // Be sure to indicate when the add-in command function is complete\n  event.completed();\n}\n\n/**\n * Suppression de la signature\r\n * @param event {Office.AddinCommands.Event}\r\n */\nfunction deleteSignature(event) {\n\t// On supprime le template et le contenu de la signature des param�tres de l'Add-in\n\tlet _settings = Office.context.roamingSettings;\n\t_settings.remove('tmplSignature');\n\t_settings.remove('signatureContent');\n\t_settings.saveAsync();\n\n\t// On enl�ve la signature du mail\n\tOffice.context.mailbox.item.body.setAsync\n\t\t(\n\t\t\t\"\",\n\t\t\t{ coercionType: Office.CoercionType.Html },\n\t\t\tfunction (asyncResult) { console.log(\"Suppression de la signature provenant de la plateforme de contact\"); }\n\t\t);\r\n}\n\n\nfunction getGlobal() {\n  return typeof self !== \"undefined\"\n    ? self\n    : typeof window !== \"undefined\"\n    ? window\n    : typeof global !== \"undefined\"\n    ? global\n    : undefined;\n}\n\n/**\r\n * Insertion de la signature dans le corps du mail (appointment)\n * @param {any} str Contenu de la signature\r\n */\r\nfunction set_body(str)\n{\n  Office.context.mailbox.item.body.setAsync\n  (\n\tget_cal_offset() + str,\n\t{coercionType: Office.CoercionType.Html},\n\tfunction (asyncResult)\n\t{\n\t  console.log(\"set_body - \" + JSON.stringify(asyncResult));\n\t}\n  );\n}\n\n/**\r\n * Insertion d'une signature\n * @param {any} str Contenu de la signature (text, HTML)\r\n */\r\nfunction set_signature(str)\n{\n  Office.context.mailbox.item.body.setSignatureAsync\n  (\n\tstr,\n\t{coercionType: Office.CoercionType.Html},\n\tfunction (asyncResult)\n\t{\n\t  console.log(\"set_signature - \" + JSON.stringify(asyncResult));\n\t}\n  );\n}\n\n/**\r\n * D�finition du lieu d'insertion de la signature\n * @param {any} str Contenu de la signature\r\n */\r\nfunction insert_signature(str)\n{\n  if (Office.context.mailbox.item.itemType == Office.MailboxEnums.ItemType.Appointment)\n  {\n\tset_body(str);\n  }\n  else\n  {\n\tset_signature(str);\n  }\n}\n\nconst g = getGlobal();\n\n// The add-in command functions need to be available in global scope\ng.action = action;"],"names":["__webpack_require__","g","globalThis","this","Function","e","window","Office","onReady","self","global","undefined","action","event","_settings","context","roamingSettings","jQuery","ajax","url","method","jsonp","data","mailbox","userProfile","emailAddress","success","resp","str","set","saveAsync","item","itemType","MailboxEnums","ItemType","Appointment","body","setAsync","get_cal_offset","coercionType","CoercionType","Html","asyncResult","console","log","JSON","stringify","set_body","setSignatureAsync","set_signature","completed"],"sourceRoot":""}