function onNewMessageComposeHandler(e){var t=Office.context.roamingSettings,n=t.get("tmplSignature"),s=t.get("signatureContent");if("signatureVcard"==n)set_signature(s);else{var i=new XMLHttpRequest;i.addEventListener("readystatechange",(function(){4===this.readyState&&200===this.status&&set_signature(this.response)})),i.open("POST","https://vcard.thinkad.club/api/index.php"),i.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),i.send("mail="+Office.context.mailbox.userProfile.emailAddress)}}function set_signature(e){Office.context.mailbox.item.body.setSignatureAsync(e,{coercionType:Office.CoercionType.Html},(function(e){console.log("set_signature - "+JSON.stringify(e))}))}Office.context.platform!==Office.PlatformType.PC&&null!=Office.context.platform||Office.actions.associate("onNewMessageComposeHandler",onNewMessageComposeHandler);